CREATE TABLE SVC_JOIN (
    CUST_ID     VARCHAR2(10) NOT NULL,
    SVC_ID      VARCHAR2(5) NOT NULL,
    JOIN_YMD    VARCHAR2(8) NOT NULL,
    JOIN_HH     VARCHAR2(4) NOT NULL,
    SVC_START_DATE DATE,
    SVC_END_DATE DATE
);

INSERT INTO SVC_JOIN VALUES ('bbbb','10001','20141201','00',TO_DATE('20150101001000','YYYYMMDDHH24MISS'),TO_DATE('20150131235959','YYYYMMDDHH24MISS'));
INSERT INTO SVC_JOIN VALUES ('cccc','10003','20141201','00',TO_DATE('20150105001000','YYYYMMDDHH24MISS'),TO_DATE('20150131235000','YYYYMMDDHH24MISS'));
INSERT INTO SVC_JOIN VALUES ('dddd','10000','20141201','02',TO_DATE('20150110001000','YYYYMMDDHH24MISS'),TO_DATE('20150131001000','YYYYMMDDHH24MISS'));
INSERT INTO SVC_JOIN VALUES ('eeee','10004','20141201','00',TO_DATE('20150120001000','YYYYMMDDHH24MISS'),TO_DATE('20150131001000','YYYYMMDDHH24MISS'));
INSERT INTO SVC_JOIN VALUES ('ffff','10005','20141201','00',TO_DATE('20150101001000','YYYYMMDDHH24MISS'),TO_DATE('20150210001000','YYYYMMDDHH24MISS'));
INSERT INTO SVC_JOIN VALUES ('gggg','10000','20141202','00',TO_DATE('20150201001000','YYYYMMDDHH24MISS'),TO_DATE('20150220001000','YYYYMMDDHH24MISS'));
INSERT INTO SVC_JOIN VALUES ('hhhh','10002','20141201','00',TO_DATE('20150201001000','YYYYMMDDHH24MISS'),TO_DATE('20150101000000','YYYYMMDDHH24MISS'));

##

## 문제 13 실행 결과가 다른 SQL은?
> 問題13  実行結果が異なるSQLは？

### (1) 
SELECT SVC_ID, COUNT(*) AS CNT
FROM SVC_JOIN
WHERE SVC_END_DATE >= TO_DATE('20150101000000','YYYYMMDDHH24MISS')
AND SVC_END_DATE <= TO_DATE('20150131235959','YYYYMMDDHH24MISS')
AND CONCAT(JOIN_YMD,JOIN_HH) = '2014120100'
GROUP BY SVC_ID;

### (2)
SELECT SVC_ID, COUNT(*) AS CNT
FROM SVC_JOIN
WHERE SVC_END_DATE >= TO_DATE('20150101','YYYYMMDD')
AND SVC_END_DATE < TO_DATE('20150201','YYYYMMDD')
AND (JOIN_YMD,JOIN_HH) IN (('20141201','00'))
GROUP BY SVC_ID;

### (3)
> 문자 '201501' 과 문자로 변환된 YYYYMM 형식을 비교하기때문에 '201501'에만 맞으면 모두 출력( =1월 전부) <br>
> 文字「201501」と文字に変換されたYYYYMM形式を比較するため、「201501」に合えば全て出力(=1月全部)

SELECT SVC_ID, COUNT(*) AS CNT
FROM SVC_JOIN
WHERE '201501' = TO_CHAR(SVC_END_DATE, 'YYYYMM')
AND JOIN_YMD = '20141201'
AND JOIN_HH = '00'
GROUP BY SVC_ID;

### (1),(2),(3) 출력
> (1),(2),(3) 出力 <br>

|SVC_ID|CNT|
|------|---|
|10003|1|
|10004|1|
|10002|1|
|10001|1|



### (4)
> 오라클에서 'YYYMM'의 형식은 해당 월의 1일을 뜻함 : 문자열 '201501' 의 DATE 변환은 20150101 이기때문에 다른 결과가 출력됨 <br>
> オラクルにおける「YYYMM」の形式は、該当月の1日を意味する:文字列「201501」のDATE変換は20150101であるため、他の結果が出力される

SELECT SVC_ID, COUNT(*) AS CNT
FROM SVC_JOIN
WHERE TO_DATE('201501','YYYYMM') = SVC_END_DATE
AND JOIN_YMD||JOIN_HH = '201412100'
GROUP BY SVC_ID;

### (4) 출력
> (4) 出力 <br>

|SVC_ID|CNT|
|------|---|


